<!DOCTYPE html>
<html lang="en-AU">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Video Trimmer Mockup — v3 (Audio Lane Fixed)</title>
  <style>
    :root {
      --bg: #0b0e14;
      --panel: #11141c;
      --panel-2: #0e1118;
      --panel-3: #0d0f15;
      --border: #1b2130;
      --muted: #95a1be;
      --text: #e8ecff;
      --accent: #7aa2ff;
      --blue: #1b2743;   /* video */
      --green-bg: #0f6a46; /* audio background */
      --green-fill: rgba(126,217,87,.38);
      --green-outline: #9af27d;
      --titlebar-h: 44px;
      --timeline-h: 380px;
      --track-h: 92px;
      --label-pad-bottom: 4px;           /* distance from lane bottom to label text */
      --label-divider-gap: 16px;
      --badge-gap: 3px;
      --lane-pad-x: 6px;         /* distance from label text to the divider line (same across lanes) */   /* per row height */
      --head-w: 140px;
      --tool-w: 56px;
      --label-edge-pad: 8px;
    }

    html, body { height: 100%; }
    body { margin:0; background:var(--bg); color:var(--text); font:14px/1.45 system-ui,-apple-system,Segoe UI,Roboto,"Helvetica Neue",Arial; overflow:hidden; }
    *,*::before,*::after{ box-sizing:border-box; }

    /* Titlebar */
    .titlebar{ height:var(--titlebar-h); display:grid; grid-template-columns:1fr auto; align-items:center; gap:12px; padding:0 12px; background:#0d1118; border-bottom:1px solid var(--border); }
    .app-brand{ display:flex; align-items:center; gap:10px; }
    .logo{ width:18px; height:18px; background:var(--accent); }
    .title{ font-weight:600; letter-spacing:.2px; }
    .toolbar{ display:flex; align-items:center; gap:8px; }
    .tbtn{ background:transparent; border:1px solid var(--border); color:var(--text); padding:6px 10px; font:inherit; }
    .tbtn.primary{ border-color:var(--accent); }

    /* Workspace */
    .workspace{ height:calc(100vh - var(--titlebar-h)); display:grid; grid-template-areas:"center" "timeline" "footer"; grid-template-rows:1fr var(--timeline-h) 40px; }

    /* Viewer */
    .center{ grid-area:center; display:grid; grid-template-rows:1fr auto; background:var(--panel-2); }
    .viewers{ display:grid; grid-template-columns:1fr; gap:10px; padding:10px; }
    .viewer{ position:relative; background:#0a0d14; border:1px solid var(--border); }
    .viewer .head{ position:absolute; left:8px; top:8px; font-size:12px; color:#cfd7f5; }
    .viewer .time{ position:absolute; right:8px; bottom:8px; font-size:12px; color:#cfd7f5; }
    .viewer .frame{ position:absolute; inset:0; display:grid; place-items:center; background:#0a0d14; }
    .drop-hint{ position:absolute; inset:15% 20%; display:flex; align-items:center; justify-content:center; color:var(--muted); border:1px dashed var(--border); font-size:14px; }

    /* Transport */
    .transport{ display:flex; align-items:center; gap:12px; padding:8px 12px; border-top:1px solid var(--border); background:var(--panel-2); }
    .transport .spacer{ flex:1; }
    .transport .timecode{ margin-left:auto; color:var(--muted); font-variant:tabular-nums; }

    /* Footer (clip info) */
    .footer{ grid-area:footer; background:var(--panel-2); border-top:1px solid var(--border); display:flex; align-items:center; padding:0 12px; color:var(--muted); }
    .footer .clip-info{ display:flex; align-items:center; gap:10px; white-space:nowrap; overflow:hidden; text-overflow:ellipsis; width:100%; }
    .footer .clip-info .name{ color:var(--text); font-weight:600; }
    .footer .clip-info span + span::before{ content:"•"; margin:0 8px; color:#55607a; }

    /* Timeline */
    .timeline{ grid-area:timeline; display:grid; grid-template-rows:28px 1fr; background:var(--panel-3); border-top:1px solid var(--border); }

    /* Ruler */
    .ruler{ position:relative; display:grid; grid-template-columns: var(--tool-w) var(--head-w) 1fr; border-bottom:1px solid var(--border); background:#0e1218; }
    .ruler .labels{ position:absolute; inset:0; display:none; /* hidden by default; duration toggles below will show one */ justify-content:space-between; align-items:center; padding-left: 0; color:#aeb7d6; font-size:12px; pointer-events:none; }
    .ruler .labels span{ flex:0 0 auto; }
    .r-span .playhead{ position:absolute; top:0; bottom:0; width:2px; background:var(--accent); left:30%; z-index:6; pointer-events:auto; }

    /* Tracks */
    .tracks{ position:relative; overflow:auto; }
    .track-row{ display:grid; grid-template-columns: var(--head-w) 1fr; min-height:var(--track-h); border-bottom:1px solid var(--border); }
    .track-head{ background:#0e121b; border-right:1px solid var(--border); display:flex; align-items:center; gap:6px; padding:6px 10px; color:#cbd4f2; white-space:nowrap; width: var(--head-w); }
    .track-head .id{ font-weight:700; width:32px; min-width:32px; height:22px; display:flex; align-items:center; justify-content:center; background:#0a0e16; border:1px solid var(--border); }
    .track-head .tog{ font-size:11px; width:22px; height:22px; display:inline-flex; align-items:center; justify-content:center; border:1px solid var(--border); background:#0c111a; color:#b8c3e8; }

    .track-lane{ position:relative; height:var(--track-h); background:var(--panel-3); overflow:hidden; }

    /* lane = the full-width content inside a track-lane */
    .lane{ position:absolute; top:0; bottom:0; left:0; right:0; }

    /* Video lane */
    .video-lane{ background:var(--blue); border:1px solid #1f2740; }
    .video-lane::before{ content:""; position:absolute; inset:0; background:repeating-linear-gradient(90deg, rgba(255,255,255,0.06) 0 1px, transparent 1px 120px); }
    .video-lane .thumbstrip{ position:absolute; left:0; right:0; top:8px; height:56%; background:
      repeating-linear-gradient(90deg, transparent 0 118px, #0b1220 118px 120px),
      repeating-linear-gradient(0deg, rgba(255,255,255,0.05) 0 10px, rgba(0,0,0,0.06) 10px 20px),
      linear-gradient(180deg, #2a416b, #1f3358);
      border:1px solid #233657; }

    /* Audio lane (FULL HEIGHT green background) */
    .audio-lane{ background:var(--green-bg); border:1px solid #1c2a21; position:absolute; top:0; bottom:0; left:0; right:0; overflow:hidden; }
    .audio-lane::before{ display:none; }

    /* Waveform: mirrored filled area, centered vertically with 10px inset */
    .audio-lane .content{ position:absolute; left:0; right:0; top: var(--badge-gap); bottom: calc(var(--label-pad-bottom) + var(--label-divider-gap)); }
.audio-lane .wave{ position:absolute; inset:0; width:100%; height:100%; z-index:1; pointer-events:none; overflow:hidden; }
    .audio-lane .path-fill{ fill:#c9f7db; shape-rendering:geometricPrecision; }
    .audio-lane .path-outline{ display:none !important; visibility:hidden; }

    /* Central gain/zero line above waveform */
    .audio-lane .gain-line{ display:none; }
    .audio-lane .gain-line .knob{ position:absolute; right:12px; top:-6px; width:12px; height:12px; border:1px solid #fff; background:#0c111a; }
  /* Stereo badges + divider (DaVinci/Premiere style) */
    .audio-lane .content .divider{ position:absolute; left:0; right:0; top:50%; transform:translateY(-50%); height:1px; z-index:2; border-radius:1px; background:rgba(47,208,130,.45); box-shadow:0 -1px 0 rgba(14,58,41,.2), 0 1px 0 rgba(14,58,41,.2); pointer-events:none; }
/* enlarge hit target without changing visual thickness */

/* audio divider: 1px visual line; separate invisible grab zone handles pointer events */
.audio-lane .content .divider-grab{ position:absolute; left:0; right:0; height:12px; top: calc(50% - 6px); z-index:3; cursor:ns-resize; background:transparent; }
/* allow default tooltip rendering for audio divider */
    .audio-lane .content .lr-badge{ position:absolute; left:0; width:14px; height:14px; line-height:14px; font-size:9px; text-align:center; color:#0b2a1f; background:rgba(47,208,130,.8); border:1px solid rgba(14,58,41,.45); border-radius:2px; box-shadow:none; z-index:3; }
    .audio-lane .content .lr-badge.l{ top: 0; }
    .audio-lane .content .lr-badge.r{ top:auto; bottom: var(--badge-gap); }
.clip-label{ position:absolute; left:6px; right:6px; bottom: var(--label-pad-bottom); font-size:12px; line-height:1.2; white-space:nowrap; overflow:hidden; text-overflow:ellipsis; pointer-events:none; opacity:.95; }
.video-lane .clip-label{ color:#dbe8ff; left:6px; right:6px; }
.audio-lane .clip-label{ color:#e6fff4; left:6px; right:6px; }
.lane .label-divider{ position:absolute; left:6px; right:6px; height:1px; background:rgba(219,232,255,.25); bottom: calc(var(--label-pad-bottom) + var(--label-divider-gap)); }
/* per-lane offsets */


/* --- Selected lane state (2) --- */
    .track-row.is-selected .video-lane{ outline:1px solid rgba(122,162,255,.35); }
    .track-row.is-selected .audio-lane{ outline:1px solid rgba(47,208,130,.35); }

    /* --- Trim handles (3) --- */
    .audio-lane .content .handle{ position:absolute; top:0; bottom:0; width:18px; pointer-events:auto; cursor:ew-resize; display:none; z-index:4; background:none; border:none; }
    .audio-lane .content .handle.left{ left:0; background:linear-gradient(90deg, rgba(47,208,130,.34), rgba(47,208,130,0)); }
    .audio-lane .content .handle.right{ right:0; background:linear-gradient(270deg, rgba(47,208,130,.34), rgba(47,208,130,0)); }
    .audio-lane .content:hover .handle{ display:block; }
    .track-row.is-selected .audio-lane .content .handle{ display:block; }

    /* --- Cleaner dividers & lane banding (4) --- */
    .track-row:nth-child(even) .lane::after{ content:""; position:absolute; inset:0; background:rgba(255,255,255,.015); pointer-events:none; z-index:0; }
    .r-lane::before{ content:""; position:absolute; top:0; bottom:0; left: 0;  right:0; background:repeating-linear-gradient(90deg, rgba(255,255,255,.06) 0 1px, transparent 1px 10px); opacity:.15; pointer-events:none; }

    /* --- Mute/Solo semantics (6) --- */
    .audio-lane.is-muted .wave{ opacity:.22; }
    .audio-lane.is-muted .lr-badge{ opacity:.45; }
    .tracks.has-solo .audio-lane:not(.is-solo){ opacity:.35; }
    .tracks.has-solo .audio-lane.is-muted{ opacity:.25; }

    /* --- Label ergonomics (7) --- */
    .clip-label .ext{ font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace; letter-spacing:.1px; }

    /* --- Tooltips (8) --- */
    [data-tip]{ position:relative; }
    [data-tip]::after{ content: attr(data-tip); position:absolute; bottom: calc(100% + 6px); left:50%; transform:translateX(-50%); background:#0b0e14; color:#e8ecff; border:1px solid #1b2130; padding:4px 6px; font-size:11px; white-space:nowrap; opacity:0; pointer-events:none; transition: opacity .15s ease 0s; border-radius:4px; }
    [data-tip]::before{ content:""; position:absolute; bottom:100%; left:50%; transform:translateX(-50%); border:6px solid transparent; border-top-color:#1b2130; opacity:0; }
    [data-tip]:hover::after,[data-tip]:hover::before{ opacity:1; transition-delay:.15s; }
/* Edge handles on *lane edges* (3, updated) */
    .lane .edge-handle{ position:absolute; top:0; bottom:0; width:18px; pointer-events:auto; cursor:ew-resize; display:none; z-index:5; background:none; border:none; }
    .video-lane .edge-handle.left{ left:0; background:linear-gradient(90deg, rgba(122,162,255,.28), rgba(122,162,255,0)); }
    .video-lane .edge-handle.right{ right:0; background:linear-gradient(270deg, rgba(122,162,255,.28), rgba(122,162,255,0)); }
    .audio-lane .edge-handle.left{ left:0; background:linear-gradient(90deg, rgba(47,208,130,.34), rgba(47,208,130,0)); }
    .audio-lane .edge-handle.right{ right:0; background:linear-gradient(270deg, rgba(47,208,130,.34), rgba(47,208,130,0)); }
    .lane:hover .edge-handle, .track-row.is-selected .lane .edge-handle{ display:block; }
/* --- Toggle buttons (visual on/off for Mute/Solo) --- */
    .track-head .tog{ position:relative; }
    .track-head .tog.mute.on{ background:#2b1720; border-color:#5b2a3a; color:#ffb3c1; }
    .track-head .tog.solo.on{ background:#0f2f21; border-color:#2fd082; color:#bdf4d4; }
    .track-head .tog.mute.off, .track-head .tog.solo.off{ opacity:.75; }

    /* Lane state pills (appear only when toggled) */
    .lane .state-pill{ position:absolute; top:6px; right:6px; font-size:10px; padding:2px 6px; border-radius:3px; border:1px solid; letter-spacing:.3px; z-index:6; }
    .audio-lane .state-pill.solo{ background:rgba(47,208,130,.15); border-color:rgba(47,208,130,.45); color:#ccffe7; }
    .audio-lane .state-pill.muted{ background:rgba(255,120,140,.10); border-color:#5b2a3a; color:#ffcbd3; }
.r-tool, .r-gutter{ background:#0e121b; border-right:1px solid var(--border); display:flex; align-items:center; padding:0 10px; color:#cbd4f2; }
.r-lane{ position:relative; }
.timeline[data-duration="30s"] .labels-30s{ display:flex; }
.timeline[data-duration="30s"] .labels-2m{ display:none; }
.timeline[data-duration="2m"] .labels-2m{ display:flex; }
.timeline[data-duration="2m"] .labels-30s{ display:none; }
.ruler .labels span:first-child{ margin-left: var(--label-edge-pad); text-align:left; }
.ruler .labels span:last-child{ margin-right: var(--label-edge-pad); text-align:right; }
/* Ruler left label (Master) */
    .r-gutter .r-label{ font-weight:700; padding:2px 6px; background:#0a0e16; border:1px solid var(--border); letter-spacing:.2px; }

    /* Master export range selector (acts on ALL lanes) */
    .r-span .master-range{ position:absolute; inset:0; pointer-events:none; z-index:3; }
    .r-span .master-range .range-fill{ position:absolute; top:0; bottom:0; left:12%; right:28%; background:rgba(122,162,255,.12); border:1px solid rgba(122,162,255,.35); pointer-events:none; }
    .r-span .master-range .handle{ position:absolute; top:0; bottom:0; width:16px; cursor:ew-resize; pointer-events:auto; z-index:5; }
    .r-span .master-range .handle.in{ left: calc(12% - 1px); background:linear-gradient(90deg, rgba(122,162,255,.38), rgba(122,162,255,0)); }
    .r-span .master-range .handle.out{ right: calc(28% - 1px); background:linear-gradient(270deg, rgba(122,162,255,.38), rgba(122,162,255,0)); }
/* Track area wrapper with vertical toolstrip */
    .trackwrap{ display:grid; grid-template-columns: var(--tool-w) 1fr; min-height:0; }
    .toolstrip{ background:#0e121b; border-right:1px solid var(--border); padding:12px 0; display:flex; flex-direction:column; align-items:center; gap:12px; position:relative; z-index:30; }
    .toolbtn{ width:40px; height:40px; display:grid; place-items:center; background:#0c111a; border:1px solid var(--border); color:#cbd4f2; border-radius:8px; }
    .toolbtn .ic{ width:20px; height:20px; fill:#b8c3e8; }
    .toolbtn.active{ border-color: var(--accent); background:#0b1220; }
    .toolbtn:hover{ background:#0e131d; }
    .toolbtn[data-tool="razor"] .ic{ stroke:#cbd4f2; fill:none; stroke-width:1.6; }

    /* Cursor hint by tool mode */
    .timeline[data-tool="select"] .tracks .lane{ cursor: default; }
    .timeline[data-tool="razor"] .tracks .lane{ cursor: crosshair; }
.r-span{ position:absolute; top:0; bottom:0; left: 0; right:0; }
.dragging, .dragging *{ user-select:none; -webkit-user-select:none; -ms-user-select:none; }
/* Tooltips: ensure they layer above everything */
[data-tip]::after, [data-tip]::before{ z-index:2000; }
/* Toolstrip tooltips: open to the RIGHT so they don't go off-screen */
.toolstrip [data-tip]::after{ left: calc(100% + 10px); bottom:auto; top:50%; transform:translateY(-50%); }
.toolstrip [data-tip]::before{ bottom:auto; top:50%; left:100%; transform:translateY(-50%); border:6px solid transparent; border-left-color:#1b2130; }
/* Disabled tool buttons */
.toolbtn[aria-disabled="true"]{ opacity:.45; cursor:not-allowed; filter:grayscale(25%); border-style:dashed; border-color:#2a3144; }
.toolbtn[aria-disabled="true"]:hover{ background:#0c111a; }
.toolbtn[aria-disabled="true"] .ic{ opacity:.75; }
/* Append note to tooltip when disabled */
[aria-disabled="true"][data-tip]::after{ content: attr(data-tip) " — disabled"; }
.float-tip{ position:fixed; padding:3px 6px; background:#0b0e14; border:1px solid #1b2130; color:#e8ecff; font-size:11px; white-space:nowrap; border-radius:4px; pointer-events:none; display:none; z-index:3000; }
.master-dim{ position:absolute; inset:0; pointer-events:none; z-index:8; }
.master-dim .dim{ position:absolute; top:0; bottom:0; background:rgba(0,0,0,.28); }
.master-dim .dim.left{ left:0; width:12%; }
.master-dim .dim.right{ right:0; width:28%; }
/* Audio gain: use floating tooltip, suppress CSS tip on grab overlay */
.divider-grab[data-tip]::after, .divider-grab[data-tip]::before{ display:none !important; }
</style>
</head>
<body>
  <header class="titlebar">
    <div class="app-brand">
      <div class="logo" aria-hidden="true"></div>
      <div class="title">TrimLab — Mockup</div>
      <span class="chip">HTML & CSS only</span>
    </div>
    <nav class="toolbar"><button class="tbtn" data-action="open">Open</button><button class="tbtn primary" data-action="export">Export</button></nav>
  </header>

  <div class="workspace">
    <section class="center">
      <div class="viewers">
        <div class="viewer">
          <div class="head">Program</div>
          <div class="frame">
            <div class="drop-hint">Drop an .mp4 here or press <strong>Ctrl+O</strong></div>
          </div>
          <div class="time">00:00:07:12</div>
        </div>
      </div>
      <div class="transport"><button class="tbtn play">Play</button><div class="spacer"></div><div class="timecode">00:00:44.10</div></div>
    </section>

    <section class="timeline" data-duration="30s" data-tool="select">
      <div class="ruler">
        <div class="r-tool"></div>
        <div class="r-gutter"><div class="r-label">Master</div></div>
        <div class="r-lane">
          <div class="r-span">
          <!-- Master range selector: this trims ALL tracks to the chosen segment on export -->
          <div class="master-range" aria-label="Master export range">
            <div class="handle in" data-tip="Master In (drag)"></div>
            <div class="range-fill" aria-hidden="true"></div>
            <div class="handle out" data-tip="Master Out (drag)"></div>
          </div>
          <div class="labels labels-30s"><span>0:00</span><span>0:05</span><span>0:10</span><span>0:15</span><span>0:20</span><span>0:25</span><span>0:30</span></div>
          <div class="labels labels-2m"><span>0:00</span><span>0:20</span><span>0:40</span><span>1:00</span><span>1:20</span><span>1:40</span><span>2:00</span></div>
          <div class="playhead" data-tip="Playhead"></div>
          </div>
        </div>
      </div>
      <div class="trackwrap">
        <aside class="toolstrip" role="toolbar" aria-label="Timeline tools">
          <!-- Selection tool (V) -->
          <button class="toolbtn active" data-tool="select" aria-pressed="true" data-tip="Selection (V)">
            <svg viewBox="0 0 24 24" class="ic" aria-hidden="true"><path d="M4 3l11 7-6 1 3 7-2 1-3-7-3 3z"/></svg>
          </button>
          <!-- Razor tool (C) -->
          <button class="toolbtn" data-tool="razor" aria-pressed="false" aria-disabled="true" data-tip="Razor (C)">
            <svg viewBox="0 0 24 24" class="ic" aria-hidden="true"><rect x="3" y="7" width="18" height="10" rx="2"/><path d="M8 7v10M16 7v10M10 12h4"/></svg>
          </button>
        </aside>
        <div class="tracks has-solo">
        <!-- Global dim outside Master range -->
        <div class="master-dim"><div class="dim left"></div><div class="dim right"></div></div>
        <!-- Video V1 -->
        <div class="track-row">
          <div class="track-head"><div class="id">V1</div><div class="tog">M</div><div class="tog">S</div></div>
          <div class="track-lane">
            <div class="lane video-lane">
              <!-- edge trim handles shown on hover/selected (3) -->
              <div class="edge-handle left" data-tip="Trim start (drag)"></div>
              <div class="edge-handle right" data-tip="Trim end (drag)"></div>
              <div class="thumbstrip" aria-hidden="true"></div>
              <div class="label-divider" aria-hidden="true"></div>
              <div class="clip-label">Gameplay<span class="ext">.mp4</span></div>
            </div>
          </div>
        </div>

        <!-- Audio A1 — EXAMPLE: SOLOED lane (.is-solo) → other audio lanes dim via .tracks.has-solo -->
        <div class="track-row">
          <div class="track-head"><div class="id">A1</div><div class="tog mute off" data-tip="Mute (M)">M</div><div class="tog solo on" data-tip="Solo (S)">S</div></div>
          <div class="track-lane">
            <div class="lane audio-lane is-solo">
              <div class="state-pill solo" aria-hidden="true">SOLO</div>
              <!-- edge trim handles shown on hover/selected (3) -->
              <div class="edge-handle left" data-tip="Trim start (drag)"></div>
              <div class="edge-handle right" data-tip="Trim end (drag)"></div>
              <div class="content">
                <!-- trim handles (3) -->
                <div class="lr-badge l">L</div>
                <div class="lr-badge r">R</div>
<svg class="wave" width="100%" height="100%" viewBox="0 0 1000 200" preserveAspectRatio="none" aria-hidden="true">
                <defs><clipPath id="clip-a1"><rect x="0" y="0" width="1000" height="200"/></clipPath></defs>
                <g clip-path="url(#clip-a1)">
                  <path class="path-fill" d="M0 100 L 20 72 L 40 126 L 60 88 L 80 140 L 100 90 L 120 134 L 140 80 L 160 150 L 180 96 L 200 130 L 220 82 L 240 148 L 260 94 L 280 128 L 300 86 L 320 142 L 340 98 L 360 126 L 380 92 L 400 138 L 420 100 L 440 122 L 460 90 L 480 136 L 500 102 L 520 124 L 540 88 L 560 140 L 580 96 L 600 132 L 620 84 L 640 146 L 660 94 L 680 128 L 700 86 L 720 144 L 740 98 L 760 126 L 780 90 L 800 138 L 820 100 L 840 122 L 860 92 L 880 136 L 900 104 L 920 124 L 940 86 L 960 142 L 980 96 L 1000 100 L 1000 100 L 0 100 Z"></path>
                  <path class="path-fill" d="M0 100 L 20 72 L 40 126 L 60 88 L 80 140 L 100 90 L 120 134 L 140 80 L 160 150 L 180 96 L 200 130 L 220 82 L 240 148 L 260 94 L 280 128 L 300 86 L 320 142 L 340 98 L 360 126 L 380 92 L 400 138 L 420 100 L 440 122 L 460 90 L 480 136 L 500 102 L 520 124 L 540 88 L 560 140 L 580 96 L 600 132 L 620 84 L 640 146 L 660 94 L 680 128 L 700 86 L 720 144 L 740 98 L 760 126 L 780 90 L 800 138 L 820 100 L 840 122 L 860 92 L 880 136 L 900 104 L 920 124 L 940 86 L 960 142 L 980 96 L 1000 100 L 1000 100 L 0 100 Z" transform="scale(1,-1) translate(0,-200)"></path>
                </g>
              </svg>
  <div class="divider"></div>
                <div class="divider-grab" data-tip="+0.0 dB"></div>
</div>
              <div class="label-divider" aria-hidden="true"></div>
              <div class="clip-label">A1 Full Mix<span class="ext">.wav</span></div>
              
            </div>
          </div>
        </div>

        <!-- Audio A2 — EXAMPLE: SELECTED lane (.is-selected) + trim handles visible + divider tooltip -->
        <div class="track-row is-selected">
          <div class="track-head"><div class="id">A2</div><div class="tog mute off" data-tip="Mute (M)">M</div><div class="tog solo off" data-tip="Solo (S)">S</div></div>
          <div class="track-lane">
            <div class="lane audio-lane">
              <!-- edge trim handles shown on hover/selected (3) -->
              <div class="edge-handle left" data-tip="Trim start (drag)"></div>
              <div class="edge-handle right" data-tip="Trim end (drag)"></div>
              <div class="content">
                <!-- trim handles (3) -->
                <div class="lr-badge l">L</div>
                <div class="lr-badge r">R</div>
<svg class="wave" width="100%" height="100%" viewBox="0 0 1000 200" preserveAspectRatio="none" aria-hidden="true">
                <!-- Top channel fill -->
                <path class="path-fill" d="M0 100 L 20 72 L 40 126 L 60 88 L 80 140 L 100 90 L 120 134 L 140 80 L 160 150 L 180 96 L 200 130 L 220 82 L 240 148 L 260 94 L 280 128 L 300 86 L 320 142 L 340 98 L 360 126 L 380 92 L 400 138 L 420 100 L 440 122 L 460 90 L 480 136 L 500 102 L 520 124 L 540 88 L 560 140 L 580 96 L 600 132 L 620 84 L 640 146 L 660 94 L 680 128 L 700 86 L 720 144 L 740 98 L 760 126 L 780 90 L 800 138 L 820 100 L 840 122 L 860 92 L 880 136 L 900 104 L 920 124 L 940 86 L 960 142 L 980 96 L 1000 100 L 1000 100 L 0 100 Z"></path>
                <!-- Bottom channel fill (mirrored) -->
                <path class="path-fill" d="M0 100 L 20 72 L 40 126 L 60 88 L 80 140 L 100 90 L 120 134 L 140 80 L 160 150 L 180 96 L 200 130 L 220 82 L 240 148 L 260 94 L 280 128 L 300 86 L 320 142 L 340 98 L 360 126 L 380 92 L 400 138 L 420 100 L 440 122 L 460 90 L 480 136 L 500 102 L 520 124 L 540 88 L 560 140 L 580 96 L 600 132 L 620 84 L 640 146 L 660 94 L 680 128 L 700 86 L 720 144 L 740 98 L 760 126 L 780 90 L 800 138 L 820 100 L 840 122 L 860 92 L 880 136 L 900 104 L 920 124 L 940 86 L 960 142 L 980 96 L 1000 100 L 1000 100 L 0 100 Z" transform="scale(1,-1) translate(0,-200)"></path>
              </svg>
  <div class="divider"></div>
                <div class="divider-grab" data-tip="+0.0 dB"></div>
</div>
              <div class="label-divider" aria-hidden="true"></div>
              <div class="clip-label">A2 Game<span class="ext">.wav</span></div>
              
            </div>
          </div>
        </div>

        <!-- Audio A3 — EXAMPLE: MUTED lane (.is-muted) -->
        <div class="track-row">
          <div class="track-head"><div class="id">A3</div><div class="tog mute on" data-tip="Mute (M)">M</div><div class="tog solo off" data-tip="Solo (S)">S</div></div>
          <div class="track-lane">
            <div class="lane audio-lane is-muted">
              <div class="state-pill muted" aria-hidden="true">MUTED</div>
              <!-- edge trim handles shown on hover/selected (3) -->
              <div class="edge-handle left" data-tip="Trim start (drag)"></div>
              <div class="edge-handle right" data-tip="Trim end (drag)"></div>
              <div class="content">
                <!-- trim handles (3) as inward-fading gradients -->
                <div class="lr-badge l">L</div>
                <div class="lr-badge r">R</div>
                <svg class="wave" width="100%" height="100%" viewBox="0 0 1000 200" preserveAspectRatio="none" aria-hidden="true">
                  <defs><clipPath id="clip-a3"><rect x="0" y="0" width="1000" height="200"/></clipPath></defs>
                  <g clip-path="url(#clip-a3)">
                    <path class="path-fill" d="M0 100 L 20 72 L 40 126 L 60 88 L 80 140 L 100 90 L 120 134 L 140 80 L 160 150 L 180 96 L 200 130 L 220 82 L 240 148 L 260 94 L 280 128 L 300 86 L 320 142 L 340 98 L 360 126 L 380 92 L 400 138 L 420 100 L 440 122 L 460 90 L 480 136 L 500 102 L 520 124 L 540 88 L 560 140 L 580 96 L 600 132 L 620 84 L 640 146 L 660 94 L 680 128 L 700 86 L 720 144 L 740 98 L 760 126 L 780 90 L 800 138 L 820 100 L 840 122 L 860 92 L 880 136 L 900 104 L 920 124 L 940 86 L 960 142 L 980 96 L 1000 100 L 1000 100 L 0 100 Z"></path>
                    <path class="path-fill" d="M0 100 L 20 72 L 40 126 L 60 88 L 80 140 L 100 90 L 120 134 L 140 80 L 160 150 L 180 96 L 200 130 L 220 82 L 240 148 L 260 94 L 280 128 L 300 86 L 320 142 L 340 98 L 360 126 L 380 92 L 400 138 L 420 100 L 440 122 L 460 90 L 480 136 L 500 102 L 520 124 L 540 88 L 560 140 L 580 96 L 600 132 L 620 84 L 640 146 L 660 94 L 680 128 L 700 86 L 720 144 L 740 98 L 760 126 L 780 90 L 800 138 L 820 100 L 840 122 L 860 92 L 880 136 L 900 104 L 920 124 L 940 86 L 960 142 L 980 96 L 1000 100 L 1000 100 L 0 100 Z" transform="scale(1,-1) translate(0,-200)"></path>
                  </g>
                </svg>
                <div class="divider"></div>
                <div class="divider-grab" data-tip="+0.0 dB"></div>
              </div>
              <div class="label-divider" aria-hidden="true"></div>
              <div class="clip-label">A3 Chat<span class="ext">.wav</span></div>
            </div>
          </div>
        </div>

        <!-- Audio A4 (FULL HEIGHT) -->
        <div class="track-row">
          <div class="track-head"><div class="id">A4</div><div class="tog mute off" data-tip="Mute (M)">M</div><div class="tog solo off" data-tip="Solo (S)">S</div></div>
          <div class="track-lane">
            <div class="lane audio-lane">
              <!-- edge trim handles shown on hover/selected (3) -->
              <div class="edge-handle left" data-tip="Trim start (drag)"></div>
              <div class="edge-handle right" data-tip="Trim end (drag)"></div>
              <div class="content">
                <!-- trim handles (3) -->
                <div class="lr-badge l">L</div>
                <div class="lr-badge r">R</div>
<svg class="wave" width="100%" height="100%" viewBox="0 0 1000 200" preserveAspectRatio="none" aria-hidden="true">
                <!-- Top channel fill -->
                <path class="path-fill" d="M0 100 L 20 72 L 40 126 L 60 88 L 80 140 L 100 90 L 120 134 L 140 80 L 160 150 L 180 96 L 200 130 L 220 82 L 240 148 L 260 94 L 280 128 L 300 86 L 320 142 L 340 98 L 360 126 L 380 92 L 400 138 L 420 100 L 440 122 L 460 90 L 480 136 L 500 102 L 520 124 L 540 88 L 560 140 L 580 96 L 600 132 L 620 84 L 640 146 L 660 94 L 680 128 L 700 86 L 720 144 L 740 98 L 760 126 L 780 90 L 800 138 L 820 100 L 840 122 L 860 92 L 880 136 L 900 104 L 920 124 L 940 86 L 960 142 L 980 96 L 1000 100 L 1000 100 L 0 100 Z"></path>
                <!-- Bottom channel fill (mirrored) -->
                <path class="path-fill" d="M0 100 L 20 72 L 40 126 L 60 88 L 80 140 L 100 90 L 120 134 L 140 80 L 160 150 L 180 96 L 200 130 L 220 82 L 240 148 L 260 94 L 280 128 L 300 86 L 320 142 L 340 98 L 360 126 L 380 92 L 400 138 L 420 100 L 440 122 L 460 90 L 480 136 L 500 102 L 520 124 L 540 88 L 560 140 L 580 96 L 600 132 L 620 84 L 640 146 L 660 94 L 680 128 L 700 86 L 720 144 L 740 98 L 760 126 L 780 90 L 800 138 L 820 100 L 840 122 L 860 92 L 880 136 L 900 104 L 920 124 L 940 86 L 960 142 L 980 96 L 1000 100 L 1000 100 L 0 100 Z" transform="scale(1,-1) translate(0,-200)"></path>
              </svg>
  <div class="divider"></div>
                <div class="divider-grab" data-tip="+0.0 dB"></div>
</div>
              <div class="label-divider" aria-hidden="true"></div>
              <div class="clip-label">A4 Aux<span class="ext">.wav</span></div>
              
            </div>
          </div>
        </div>
      </div>  <!-- end .tracks -->
      </div>  <!-- end .trackwrap -->
    </section>
    <footer class="footer">
      <div class="clip-info">
        <span class="name">game_2025-09-01_18-22-10.mp4</span>
        <span class="range">Range <strong id="footerIn">0:00</strong>–<strong id="footerOut">0:30</strong></span>
        <span class="length">Length <strong id="footerLen">0:30</strong></span>
        <span class="mode">Export <strong id="footerMode">Copy</strong></span>
      </div>
    </footer>
  </div>
  <script>
  // Mouse-only Master Range dragging (no I/O keyboard shortcuts)
  (function(){
    const span = document.querySelector('.r-span');
    if(!span) return;
    const range = span.querySelector('.master-range');
    const fill  = range?.querySelector('.range-fill');
    const inH   = range?.querySelector('.handle.in');
    const outH  = range?.querySelector('.handle.out');

    // Initial positions (percent of visible lane width)
    let inPct  = 12;   // left edge at 12%
    let outPct = 72;
    function durationSec(){ const tl = document.querySelector('.timeline'); const d = tl?.dataset.duration || '30s'; if(/m$/i.test(d)) return (parseFloat(d)||0)*60; if(/s$/i.test(d)) return parseFloat(d)||30; return 30; }
    function fmtTime(total){ total = Math.max(0, Math.round(total)); const m = Math.floor(total/60); const s = total - m*60; return `${m}:${String(s).padStart(2,'0')}`; }
    const tracksEl = document.querySelector('.tracks');
    const dimLeft = tracksEl?.querySelector('.master-dim .dim.left');
    const dimRight = tracksEl?.querySelector('.master-dim .dim.right');
    const fIn = document.getElementById('footerIn');
    const fOut = document.getElementById('footerOut');
    const fLen = document.getElementById('footerLen');
    const fMode = document.getElementById('footerMode');
    function apply(){ 
      if(!fill || !inH || !outH) return;
      fill.style.left  = inPct + '%';
      fill.style.right = (100 - outPct) + '%';
      inH.style.left   = `calc(${inPct}% - 1px)`; inH.style.right  = '';
      outH.style.right = `calc(${100 - outPct}% - 1px)`; outH.style.left = '';
      // expose values for export logic
      span.dataset.masterIn  = inPct.toFixed(3);
      span.dataset.masterOut = outPct.toFixed(3);
      // update dims
      if(dimLeft && dimRight){ dimLeft.style.width = inPct + '%'; dimRight.style.width = (100 - outPct) + '%'; }
      // update footer readout
      const dur = durationSec();
      const inT = dur * inPct/100; const outT = dur * outPct/100; const len = Math.max(0, outT - inT);
      if(fIn)  fIn.textContent  = fmtTime(inT);
      if(fOut) fOut.textContent = fmtTime(outT);
      if(fLen) fLen.textContent = fmtTime(len);
      if(fMode) fMode.textContent = (inPct<=0.01 && outPct>=99.99) ? 'Copy' : 'Precise';
    }
    apply();

    // Playhead hover: show current time
    const playhead = span.querySelector('.playhead');
    function showPlayheadTip(ev){
      if(!playhead) return;
      const sr = span.getBoundingClientRect();
      const pr = playhead.getBoundingClientRect();
      const pct = ((pr.left - sr.left) / sr.width) * 100;
      const time = durationSec() * pct / 100;
      showTip(ev.clientX, ev.clientY, fmtTime(time));
    }
    playhead?.addEventListener('mouseenter', showPlayheadTip);
    playhead?.addEventListener('mousemove', showPlayheadTip);
    playhead?.addEventListener('mouseleave', ()=> hideTip());

    function pctFromEvent(e){
      const r = span.getBoundingClientRect();
      const x = Math.min(Math.max(e.clientX - r.left, 0), r.width);
      return (x / r.width) * 100;
    }

    function startDrag(which, e){
      e.preventDefault();
      document.body.classList.add('dragging');
      const move = (ev)=>{
        const p = pctFromEvent(ev);
        if(which === 'in'){
          inPct = Math.min(Math.max(0, p), outPct - 0.1);
        }else{
          outPct = Math.max(Math.min(100, p), inPct + 0.1);
        }
        apply();
        showMasterTip(ev);
      };
      const up = ()=>{
        document.body.classList.remove('dragging');
        window.removeEventListener('mousemove', move);
        window.removeEventListener('mouseup', up);
      }; // end mouseup
      window.addEventListener('mousemove', move);
      window.addEventListener('mouseup', up);
    }

    inH?.addEventListener('mousedown', (e)=> startDrag('in', e));
    outH?.addEventListener('mousedown', (e)=> startDrag('out', e));

    // Master handle hover: show IN/OUT/LEN pill
    function showMasterTip(ev){
      const dur = durationSec(); const inT = dur * inPct/100; const outT = dur * outPct/100; const len = Math.max(0, outT - inT);
      const text = `IN ${fmtTime(inT)}  OUT ${fmtTime(outT)}  LEN ${fmtTime(len)}`;
      showTip(ev.clientX, ev.clientY, text);
    }
    inH?.addEventListener('mouseenter', showMasterTip);
    inH?.addEventListener('mousemove', showMasterTip);
    inH?.addEventListener('mouseleave', ()=> hideTip());
    outH?.addEventListener('mouseenter', showMasterTip);
    outH?.addEventListener('mousemove', showMasterTip);
    outH?.addEventListener('mouseleave', ()=> hideTip());

    // Convenience: click anywhere in the ruler span to move the nearest edge
    span.addEventListener('mousedown', (e)=>{
      if(e.target.closest('.handle')) return; // those are handled above
      const p = pctFromEvent(e);
      if(Math.abs(p - inPct) <= Math.abs(p - outPct)){
        inPct = Math.min(Math.max(0, p), outPct - 0.1);
      } else {
        outPct = Math.max(Math.min(100, p), inPct + 0.1);
      }
      apply();
    });
  })();
  </script>
  <div id="__float_tip" class="float-tip" style="display:none"></div>
  <script>
  // Audio lane gain drag with floating dB tooltip (mouse-only)
  (function(){
    const tip = document.getElementById('__float_tip');
    if(!tip) return;

    function showTip(x,y,text){
      tip.textContent = text;
      tip.style.display = 'block';
      // place above cursor; clamp to viewport
      requestAnimationFrame(()=>{
        const r = tip.getBoundingClientRect();
        let left = x - r.width/2; left = Math.max(6, Math.min(window.innerWidth - r.width - 6, left));
        let top  = y - r.height - 12; if(top < 6) top = y + 16; // fallback below if too close to top
        tip.style.left = left + 'px';
        tip.style.top  = top  + 'px';
      });
    }
    function hideTip(){ tip.style.display = 'none'; }

    function mapPctToDb(pct){
      // 50% => 0 dB; top => +24 dB; bottom => -24 dB
      const db = ((50 - pct) / 50) * 24; // linear mockup mapping
      return Math.max(-24, Math.min(24, db));
    }
    const formatDb = v => (v >= 0 ? '+' : '') + v.toFixed(1) + ' dB';

    document.querySelectorAll('.audio-lane .content .divider-grab').forEach(divider => {
      const content = divider.parentElement;
      const line = content.querySelector('.divider');
      const grab = divider;  // overlay that handles pointer + tooltip
      if(!line.style.top) line.style.top = '50%';
      if(!grab.style.top) grab.style.top = 'calc(50% - 6px)';
      let dragging = false;

      const updateFromEvent = (ev)=>{
        const rect = content.getBoundingClientRect();
        const GH = 12; // grab overlay height
        let yRaw = ev.clientY - rect.top;
        // Clamp so the 1px line never gets clipped by overflow at top/bottom
        let y = Math.min(Math.max(yRaw, 1), rect.height - 1);
        const pct = (y / rect.height) * 100;
        if(line) line.style.top = pct + '%';
        // Keep the 12px grab zone fully inside the content area
        let gy = Math.min(Math.max(y - GH/2, 0), rect.height - GH);
        grab.style.top = gy + 'px';
        const db = mapPctToDb(pct);
        showTip(ev.clientX, ev.clientY, formatDb(db));
        divider.dataset.tip = formatDb(db);
        content.closest('.audio-lane')?.setAttribute('data-gain-db', db.toFixed(2));
      };

      const onDown = (e)=>{
        if(e.button !== 0) return; // left click only
        e.preventDefault();
        document.body.classList.add('dragging');
        dragging = true;
        updateFromEvent(e);
        const onMove = (ev)=>{ if(dragging) updateFromEvent(ev); };
        const onUp = ()=>{
          dragging = false;
          document.body.classList.remove('dragging');
          hideTip();
          window.removeEventListener('mousemove', onMove);
          window.removeEventListener('mouseup', onUp);
        };
        window.addEventListener('mousemove', onMove);
        window.addEventListener('mouseup', onUp);
      };

      divider.addEventListener('mousedown', onDown);

      // show floating dB tooltip on hover (not just while dragging)
      const onHover = (ev)=>{
        if(dragging) return; // dragging handler already updates line & tip
        // Derive from the *actual line* position, not the cursor
        let pct = parseFloat(line.style.top) || 50;
        const db = mapPctToDb(pct);
        showTip(ev.clientX, ev.clientY, formatDb(db));
        divider.dataset.tip = formatDb(db);
      };
      divider.addEventListener('mouseenter', onHover);
      divider.addEventListener('mousemove', onHover);
      divider.addEventListener('mouseleave', ()=>{ if(!dragging) hideTip(); });
    });
  })();
  </script>
</body>
</html>
